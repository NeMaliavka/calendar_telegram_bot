# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### 1. UnboundLocalError –≤ booking_service.py
**–û—à–∏–±–∫–∞:** `cannot access local variable 'child' where it is not associated with a value`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `child` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ (—Å—Ç—Ä–æ–∫–∞ 178)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# –ë—ã–ª–æ:
child_id = child.id  # child –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –µ—Å–ª–∏ children –Ω–µ –ø—É—Å—Ç

# –°—Ç–∞–ª–æ:
child_id = child.id if child else None
```

–¢–∞–∫–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `add_child_profile()` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

---

### 2. –ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª—Å—è –∏–Ω—Ç–µ–Ω—Ç "–ø–æ–∑–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"
**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–ø—Ä–æ—Å "–ø–æ–∑–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞" –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª –∏–Ω—Ç–µ–Ω—Ç `human_operator`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ `config/keywords.yaml`:
- "–ø–æ–∑–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"
- "–ø–æ–∑–æ–≤–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞"
- "—Ö–æ—á—É –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º"
- "—Å–æ–µ–¥–∏–Ω–∏ —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º"

---

### 3. SSL –æ—à–∏–±–∫–∏ PostHog (—Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è ChromaDB)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ SSL –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏:
```
[SSL: WRONG_VERSION_NUMBER] wrong version number
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –≤ `backend/knowledge_base/loader.py`:
```python
os.environ.setdefault("ANONYMIZED_TELEMETRY", "False")
os.environ.setdefault("DO_NOT_TRACK", "1")
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–∏ –æ—à–∏–±–∫–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞, –Ω–æ –∑–∞—Å–æ—Ä—è—é—Ç –ª–æ–≥–∏.

---

## üê≥ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
‚úÖ **Dockerfile** –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
‚úÖ **docker-compose.yml** –Ω–∞—Å—Ç—Ä–æ–µ–Ω  
‚úÖ **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã  
‚úÖ **–¢–µ–ª–µ–º–µ—Ç—Ä–∏—è** –æ—Ç–∫–ª—é—á–µ–Ω–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞

#### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:
```bash
docker build -t calendar-bot .
```

#### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ docker-compose:
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker-compose logs bot
docker-compose logs scheduler
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –≤–µ—Ä—Å–∏–∏ 20.10+
- Docker Compose –≤–µ—Ä—Å–∏–∏ 1.29+
- –§–∞–π–ª `.env` —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- –§–∞–π–ª `google-credentials.json` –¥–ª—è Google API

---

## üìä –ê–Ω–∞–ª–∏–∑ —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ **PROJECT_ANALYSIS.md**

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ë–î (–Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ DATABASE_URL)
2. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
3. ‚ö†Ô∏è –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. ‚ö†Ô∏è –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î –Ω–µ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞

### –í–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
5. –ù–µ—Ç retry –ª–æ–≥–∏–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
6. –ù–µ—Ç rate limiting
7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ
8. –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –º–µ—Ç—Ä–∏–∫
9. –°–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ (–Ω—É–∂–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è .env)
10. –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å–æ–±—ã—Ç–∏–π

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–∫—Ä–∏—Ç–∏—á–Ω–æ):
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å UnboundLocalError - **–ì–û–¢–û–í–û**
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ - **–ì–û–¢–û–í–û**
3. ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é - **–ì–û–¢–û–í–û**
4. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ DATABASE_URL –≤–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ë–î
5. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è:
6. –î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É –¥–ª—è GigaChat –∏ Google API
7. –î–æ–±–∞–≤–∏—Ç—å rate limiting
8. –£–ª—É—á—à–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
9. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:
10. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã
11. –£–ª—É—á—à–∏—Ç—å Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (multi-stage build)
12. –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫:**
   ```bash
   # –í –ª–æ–≥–∞—Ö –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   # UnboundLocalError: cannot access local variable 'child'
   ```

2. **–ò–Ω—Ç–µ–Ω—Ç "–ø–æ–∑–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞" —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É: "–ø–æ–∑–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"
   - –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏—Å—å –∏–Ω—Ç–µ–Ω—Ç `human_operator`

3. **–ù–µ—Ç SSL –æ—à–∏–±–æ–∫ PostHog:**
   - –í –ª–æ–≥–∞—Ö –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫:
   # [SSL: WRONG_VERSION_NUMBER] wrong version number

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
- –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ñ–∞–π–ª–µ `PROJECT_ANALYSIS.md`

